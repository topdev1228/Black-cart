{
  "version": 3,
  "sources": ["../../../node_modules/@shopify/admin-ui-extensions/build/esm/api.mjs", "../../../node_modules/@remote-ui/core/build/esm/component.mjs", "../../../node_modules/@shopify/admin-ui-extensions/build/esm/components/BlockStack/BlockStack.mjs", "../../../node_modules/@shopify/admin-ui-extensions/build/esm/components/Checkbox/Checkbox.mjs", "../../../node_modules/@shopify/admin-ui-extensions/build/esm/components/Text/Text.mjs", "../src/index.ts"],
  "sourceRoot": "/app/extensions/subscription-ui/src",
  "sourcesContent": ["function extend(extensionPoint, callback) {\n  return self.shopify.extend(extensionPoint, callback);\n}\n\nexport { extend };\n", "function createRemoteComponent(componentType) {\n  return componentType;\n}\n\nexport { createRemoteComponent };\n", "import { createRemoteComponent } from '@remote-ui/core';\n\n/**\n * Use to achieve no-fuss vertical centering.\n *\n * A stack is made of flexible items that wrap each of the stack\u2019s children. Options provide control of the alignment and spacing of the items in the stack.\n * Use `StackItem` to group multiple elements inside a `BlockStack` together.\n */\nconst BlockStack = createRemoteComponent('BlockStack');\n\nexport { BlockStack };\n", "import { createRemoteComponent } from '@remote-ui/core';\n\n/**\n * Checkboxes are most commonly used to give merchants a way to make a range of selections (zero, one, or multiple).\n */\nconst Checkbox = createRemoteComponent('Checkbox');\n\nexport { Checkbox };\n", "import { createRemoteComponent } from '@remote-ui/core';\n\n/**\n * The Text component is used to render text in different sizes, colors, and alignments.\n */\nconst Text = createRemoteComponent('Text');\n\nexport { Text };\n", "import {BlockStack, Checkbox, extend, Text} from '@shopify/admin-ui-extensions';\n\n// Your extension must render all four modes\nextend('Admin::Product::SubscriptionPlan::Add', Add);\nextend('Admin::Product::SubscriptionPlan::Create', Create);\nextend('Admin::Product::SubscriptionPlan::Remove', Remove);\nextend('Admin::Product::SubscriptionPlan::Edit', Edit);\n\nfunction Edit(root, {extensionPoint}) {\n    root.appendChild(\n        root.createComponent(\n            Text,\n            {},\n            `Selling plan options are coming soon. Go to the Blackcart app to modify your existing selling plan`,\n        ),\n    );\n    root.mount();\n}\n\nfunction Create(root, {extensionPoint}) {\n    root.appendChild(\n        root.createComponent(\n            Text,\n            {},\n            `Selling plan options are coming soon. Go to the Blackcart app to modify your existing selling plan`,\n        ),\n    );\n    root.mount();\n}\n\nconst backend = 'https://shop-app.blackcart.com';\n\nasync function fetchProgramId(sessionToken) {\n    const token = await sessionToken.getSessionToken();\n    const response = await fetch(backend + '/api/stores/programs', {\n        headers: {\n            Authorization: 'Bearer ' + token || 'unknown token',\n        },\n    });\n    const responseData = await response.json();\n    return responseData.programs[0].id;\n}\n\nasync function fetchVariants(sessionToken, productId, variantId) {\n    const token = await sessionToken.getSessionToken();\n    const response = await fetch(backend + '/api/stores/products/' + productId, {\n        headers: {\n            Authorization: 'Bearer ' + token || 'unknown token',\n        },\n    });\n    const responseData = await response.json();\n    if (variantId !== undefined) {\n        const filteredVariants = responseData.data.product.variants.edges.filter(\n            (variant) => variant.node.id === variantId,\n        );\n\n        responseData.data.product.variants.edges = filteredVariants;\n    }\n    return responseData;\n}\n\nasync function variantsInSellingPlan(sessionToken, variantIds, programId) {\n    const token = await sessionToken.getSessionToken();\n    const encodedVariantIds = variantIds.map((id) => encodeURIComponent(id)).join('&');\n    const url = `${backend}/api/stores/programs/${programId}/variants?shopify_variant_ids=${encodedVariantIds}`;\n\n    const response = await fetch(url, {\n        method: 'GET',\n        headers: {\n            'Content-Type': 'application/json',\n            Authorization: 'Bearer ' + token || 'unknown token',\n        },\n    });\n    const responseData = await response.json();\n    return responseData;\n}\n\nconst selectedVariants = {};\nlet program = '';\n\nfunction Add(root, api) {\n    const {close, done, setPrimaryAction, setSecondaryAction} = api.container;\n\n    setPrimaryAction({\n        content: 'Add to plan',\n        onAction: async () => {\n            // Get a fresh session token before every call to your app server.\n            const token = await sessionToken.getSessionToken();\n\n            const selectedVariantIds = Object.keys(selectedVariants);\n\n            const formData = {\n                productId: api.data.productId,\n                selected_variant_ids: selectedVariantIds,\n            };\n\n            const response = await fetch(backend + '/api/stores/programs/' + program + '/variants', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    Authorization: 'Bearer ' + token || 'unknown token',\n                },\n                body: JSON.stringify(formData),\n            });\n            done();\n        },\n    });\n    setSecondaryAction({\n        content: 'Cancel',\n        onAction: () => close(),\n    });\n\n    const sessionToken = api.sessionToken;\n    const parts = api.data.productId.split('/');\n    const productId = parts[parts.length - 1];\n    const variantId = api.data.variantId;\n    fetchProgramId(sessionToken).then((programId) => {\n        program = programId;\n        fetchVariants(sessionToken, productId, variantId)\n            .then((responseData) => {\n                const variants = responseData.data.product.variants.edges;\n                const variantIds = variants.map((variant) => variant.node.id);\n                variantsInSellingPlan(sessionToken, variantIds, program)\n                    .then((variantsInSellingPlanData) => {\n                        const filteredVariants = variants.filter((variant) => {\n                            const variantId = variant.node.id.split('/').pop();\n                            const sellingPlanKey = `productVariant${variantId}`;\n                            return !variantsInSellingPlanData.data.sellingPlanGroup[sellingPlanKey];\n                        });\n                        const blockStack = root.createComponent(BlockStack, {\n                            inlineAlignment: 'leading',\n                            spacing: 'tight',\n                        });\n\n                        const addText =\n                            variantId !== undefined ? 'Add variant to TBYB' : 'Add product and variants to TBYB';\n                        const allVariantsAdded =\n                            variantId !== undefined\n                                ? 'Variant already added to TBYB'\n                                : 'All variants are already added to TBYB';\n                        if (filteredVariants === undefined || filteredVariants.length == 0) {\n                            blockStack.appendChild(root.createComponent(Text, {}, allVariantsAdded));\n                        } else {\n                            blockStack.appendChild(root.createComponent(Text, {}, addText));\n                        }\n\n                        const handleCheckboxChange = (variantId, variantName, isChecked, checkbox) => {\n                            checkbox.updateProps({checked: isChecked});\n                            if (isChecked) {\n                                selectedVariants[variantId] = variantName;\n                            } else {\n                                delete selectedVariants[variantId];\n                            }\n                        };\n\n                        // Create checkboxes dynamically for each variant\n                        filteredVariants.forEach((variant) => {\n                            const variantName = variant.node.displayName;\n                            const variantId = variant.node.id;\n                            const checkbox = root.createComponent(Checkbox, {\n                                label: `${variantName}`,\n                                onChange: (isChecked) =>\n                                    handleCheckboxChange(variantId, variantName, isChecked, checkbox),\n                            });\n                            blockStack.appendChild(checkbox);\n                        });\n\n                        root.appendChild(blockStack);\n                        root.mount();\n                    })\n                    .catch((error) => {\n                        console.error('Error fetching data:', error);\n                    });\n            })\n            .catch((error) => {\n                console.error('Error fetching data:', error);\n            });\n    });\n}\n\nfunction Remove(root, api) {\n    const {close, done, setPrimaryAction, setSecondaryAction} = api.container;\n\n    setPrimaryAction({\n        content: 'Remove from plan',\n        onAction: async () => {\n            // Get a fresh session token before every call to your app server.\n            const token = await sessionToken.getSessionToken();\n\n            const selectedVariantIds = Object.keys(selectedVariants);\n\n            const formData = {\n                productId: api.data.productId,\n                selected_variant_ids: selectedVariantIds,\n            };\n\n            const response = await fetch(backend + '/api/stores/programs/' + program + '/variants', {\n                method: 'DELETE',\n                headers: {\n                    'Content-Type': 'application/json',\n                    Authorization: 'Bearer ' + token || 'unknown token',\n                },\n                body: JSON.stringify(formData),\n            });\n            done();\n        },\n    });\n    setSecondaryAction({\n        content: 'Cancel',\n        onAction: () => close(),\n    });\n\n    const sessionToken = api.sessionToken;\n    const parts = api.data.productId.split('/');\n    const productId = parts[parts.length - 1];\n    const variantId = api.data.variantId;\n\n    fetchProgramId(sessionToken).then((programId) => {\n        program = programId;\n        fetchVariants(sessionToken, productId, variantId)\n            .then((responseData) => {\n                const variants = responseData.data.product.variants.edges;\n                const variantIds = variants.map((variant) => variant.node.id);\n                variantsInSellingPlan(sessionToken, variantIds, program)\n                    .then((variantsInSellingPlanData) => {\n                        const filteredVariants = variants.filter((variant) => {\n                            const variantId = variant.node.id.split('/').pop();\n                            const sellingPlanKey = `productVariant${variantId}`;\n                            return variantsInSellingPlanData.data.sellingPlanGroup[sellingPlanKey];\n                        });\n                        const blockStack = root.createComponent(BlockStack, {\n                            inlineAlignment: 'leading',\n                            spacing: 'tight',\n                        });\n\n                        const removeText =\n                            variantId !== undefined ? 'Remove variant from TBYB' : 'Remove variants from TBYB';\n                        blockStack.appendChild(root.createComponent(Text, {}, removeText));\n\n                        const handleCheckboxChange = (variantId, variantName, isChecked, checkbox) => {\n                            checkbox.updateProps({checked: isChecked});\n                            if (isChecked) {\n                                selectedVariants[variantId] = variantName;\n                            } else {\n                                delete selectedVariants[variantId];\n                            }\n                        };\n\n                        // Create checkboxes dynamically for each variant\n                        filteredVariants.forEach((variant) => {\n                            const variantName = variant.node.displayName;\n                            const variantId = variant.node.id;\n                            const checkbox = root.createComponent(Checkbox, {\n                                label: `${variantName}`,\n                                onChange: (isChecked) =>\n                                    handleCheckboxChange(variantId, variantName, isChecked, checkbox),\n                            });\n                            blockStack.appendChild(checkbox);\n                        });\n\n                        root.appendChild(blockStack);\n                        root.mount();\n                    })\n                    .catch((error) => {\n                        console.error('Error fetching data:', error);\n                    });\n            })\n            .catch((error) => {\n                console.error('Error fetching data:', error);\n            });\n    });\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;AAAA,WAAS,OAAO,gBAAgB,UAAU;AACxC,WAAO,KAAK,QAAQ,OAAO,gBAAgB,QAAQ;AAAA,EACrD;;;ACFA,WAAS,sBAAsB,eAAe;AAC5C,WAAO;AAAA,EACT;;;ACMA,MAAM,aAAa,sBAAsB,YAAY;;;ACHrD,MAAM,WAAW,sBAAsB,UAAU;;;ACAjD,MAAM,OAAO,sBAAsB,MAAM;;;ACFzC,SAAO,yCAAyC,GAAG;AACnD,SAAO,4CAA4C,MAAM;AACzD,SAAO,4CAA4C,MAAM;AACzD,SAAO,0CAA0C,IAAI;AAErD,WAAS,KAAK,MAAM,EAAC,eAAc,GAAG;AAClC,SAAK;AAAA,MACD,KAAK;AAAA,QACD;AAAA,QACA,CAAC;AAAA,QACD;AAAA,MACJ;AAAA,IACJ;AACA,SAAK,MAAM;AAAA,EACf;AAEA,WAAS,OAAO,MAAM,EAAC,eAAc,GAAG;AACpC,SAAK;AAAA,MACD,KAAK;AAAA,QACD;AAAA,QACA,CAAC;AAAA,QACD;AAAA,MACJ;AAAA,IACJ;AACA,SAAK,MAAM;AAAA,EACf;AAEA,MAAM,UAAU;AAEhB,WAAe,eAAe,cAAc;AAAA;AACxC,YAAM,QAAQ,MAAM,aAAa,gBAAgB;AACjD,YAAM,WAAW,MAAM,MAAM,UAAU,wBAAwB;AAAA,QAC3D,SAAS;AAAA,UACL,eAAe,YAAY,SAAS;AAAA,QACxC;AAAA,MACJ,CAAC;AACD,YAAM,eAAe,MAAM,SAAS,KAAK;AACzC,aAAO,aAAa,SAAS,CAAC,EAAE;AAAA,IACpC;AAAA;AAEA,WAAe,cAAc,cAAc,WAAW,WAAW;AAAA;AAC7D,YAAM,QAAQ,MAAM,aAAa,gBAAgB;AACjD,YAAM,WAAW,MAAM,MAAM,UAAU,0BAA0B,WAAW;AAAA,QACxE,SAAS;AAAA,UACL,eAAe,YAAY,SAAS;AAAA,QACxC;AAAA,MACJ,CAAC;AACD,YAAM,eAAe,MAAM,SAAS,KAAK;AACzC,UAAI,cAAc,QAAW;AACzB,cAAM,mBAAmB,aAAa,KAAK,QAAQ,SAAS,MAAM;AAAA,UAC9D,CAAC,YAAY,QAAQ,KAAK,OAAO;AAAA,QACrC;AAEA,qBAAa,KAAK,QAAQ,SAAS,QAAQ;AAAA,MAC/C;AACA,aAAO;AAAA,IACX;AAAA;AAEA,WAAe,sBAAsB,cAAc,YAAY,WAAW;AAAA;AACtE,YAAM,QAAQ,MAAM,aAAa,gBAAgB;AACjD,YAAM,oBAAoB,WAAW,IAAI,CAAC,OAAO,mBAAmB,EAAE,CAAC,EAAE,KAAK,GAAG;AACjF,YAAM,MAAM,GAAG,OAAO,wBAAwB,SAAS,iCAAiC,iBAAiB;AAEzG,YAAM,WAAW,MAAM,MAAM,KAAK;AAAA,QAC9B,QAAQ;AAAA,QACR,SAAS;AAAA,UACL,gBAAgB;AAAA,UAChB,eAAe,YAAY,SAAS;AAAA,QACxC;AAAA,MACJ,CAAC;AACD,YAAM,eAAe,MAAM,SAAS,KAAK;AACzC,aAAO;AAAA,IACX;AAAA;AAEA,MAAM,mBAAmB,CAAC;AAC1B,MAAI,UAAU;AAEd,WAAS,IAAI,MAAM,KAAK;AACpB,UAAM,EAAC,OAAO,MAAM,kBAAkB,mBAAkB,IAAI,IAAI;AAEhE,qBAAiB;AAAA,MACb,SAAS;AAAA,MACT,UAAU,MAAY;AAElB,cAAM,QAAQ,MAAM,aAAa,gBAAgB;AAEjD,cAAM,qBAAqB,OAAO,KAAK,gBAAgB;AAEvD,cAAM,WAAW;AAAA,UACb,WAAW,IAAI,KAAK;AAAA,UACpB,sBAAsB;AAAA,QAC1B;AAEA,cAAM,WAAW,MAAM,MAAM,UAAU,0BAA0B,UAAU,aAAa;AAAA,UACpF,QAAQ;AAAA,UACR,SAAS;AAAA,YACL,gBAAgB;AAAA,YAChB,eAAe,YAAY,SAAS;AAAA,UACxC;AAAA,UACA,MAAM,KAAK,UAAU,QAAQ;AAAA,QACjC,CAAC;AACD,aAAK;AAAA,MACT;AAAA,IACJ,CAAC;AACD,uBAAmB;AAAA,MACf,SAAS;AAAA,MACT,UAAU,MAAM,MAAM;AAAA,IAC1B,CAAC;AAED,UAAM,eAAe,IAAI;AACzB,UAAM,QAAQ,IAAI,KAAK,UAAU,MAAM,GAAG;AAC1C,UAAM,YAAY,MAAM,MAAM,SAAS,CAAC;AACxC,UAAM,YAAY,IAAI,KAAK;AAC3B,mBAAe,YAAY,EAAE,KAAK,CAAC,cAAc;AAC7C,gBAAU;AACV,oBAAc,cAAc,WAAW,SAAS,EAC3C,KAAK,CAAC,iBAAiB;AACpB,cAAM,WAAW,aAAa,KAAK,QAAQ,SAAS;AACpD,cAAM,aAAa,SAAS,IAAI,CAAC,YAAY,QAAQ,KAAK,EAAE;AAC5D,8BAAsB,cAAc,YAAY,OAAO,EAClD,KAAK,CAAC,8BAA8B;AACjC,gBAAM,mBAAmB,SAAS,OAAO,CAAC,YAAY;AAClD,kBAAMA,aAAY,QAAQ,KAAK,GAAG,MAAM,GAAG,EAAE,IAAI;AACjD,kBAAM,iBAAiB,iBAAiBA,UAAS;AACjD,mBAAO,CAAC,0BAA0B,KAAK,iBAAiB,cAAc;AAAA,UAC1E,CAAC;AACD,gBAAM,aAAa,KAAK,gBAAgB,YAAY;AAAA,YAChD,iBAAiB;AAAA,YACjB,SAAS;AAAA,UACb,CAAC;AAED,gBAAM,UACF,cAAc,SAAY,wBAAwB;AACtD,gBAAM,mBACF,cAAc,SACR,kCACA;AACV,cAAI,qBAAqB,UAAa,iBAAiB,UAAU,GAAG;AAChE,uBAAW,YAAY,KAAK,gBAAgB,MAAM,CAAC,GAAG,gBAAgB,CAAC;AAAA,UAC3E,OAAO;AACH,uBAAW,YAAY,KAAK,gBAAgB,MAAM,CAAC,GAAG,OAAO,CAAC;AAAA,UAClE;AAEA,gBAAM,uBAAuB,CAACA,YAAW,aAAa,WAAW,aAAa;AAC1E,qBAAS,YAAY,EAAC,SAAS,UAAS,CAAC;AACzC,gBAAI,WAAW;AACX,+BAAiBA,UAAS,IAAI;AAAA,YAClC,OAAO;AACH,qBAAO,iBAAiBA,UAAS;AAAA,YACrC;AAAA,UACJ;AAGA,2BAAiB,QAAQ,CAAC,YAAY;AAClC,kBAAM,cAAc,QAAQ,KAAK;AACjC,kBAAMA,aAAY,QAAQ,KAAK;AAC/B,kBAAM,WAAW,KAAK,gBAAgB,UAAU;AAAA,cAC5C,OAAO,GAAG,WAAW;AAAA,cACrB,UAAU,CAAC,cACP,qBAAqBA,YAAW,aAAa,WAAW,QAAQ;AAAA,YACxE,CAAC;AACD,uBAAW,YAAY,QAAQ;AAAA,UACnC,CAAC;AAED,eAAK,YAAY,UAAU;AAC3B,eAAK,MAAM;AAAA,QACf,CAAC,EACA,MAAM,CAAC,UAAU;AACd,kBAAQ,MAAM,wBAAwB,KAAK;AAAA,QAC/C,CAAC;AAAA,MACT,CAAC,EACA,MAAM,CAAC,UAAU;AACd,gBAAQ,MAAM,wBAAwB,KAAK;AAAA,MAC/C,CAAC;AAAA,IACT,CAAC;AAAA,EACL;AAEA,WAAS,OAAO,MAAM,KAAK;AACvB,UAAM,EAAC,OAAO,MAAM,kBAAkB,mBAAkB,IAAI,IAAI;AAEhE,qBAAiB;AAAA,MACb,SAAS;AAAA,MACT,UAAU,MAAY;AAElB,cAAM,QAAQ,MAAM,aAAa,gBAAgB;AAEjD,cAAM,qBAAqB,OAAO,KAAK,gBAAgB;AAEvD,cAAM,WAAW;AAAA,UACb,WAAW,IAAI,KAAK;AAAA,UACpB,sBAAsB;AAAA,QAC1B;AAEA,cAAM,WAAW,MAAM,MAAM,UAAU,0BAA0B,UAAU,aAAa;AAAA,UACpF,QAAQ;AAAA,UACR,SAAS;AAAA,YACL,gBAAgB;AAAA,YAChB,eAAe,YAAY,SAAS;AAAA,UACxC;AAAA,UACA,MAAM,KAAK,UAAU,QAAQ;AAAA,QACjC,CAAC;AACD,aAAK;AAAA,MACT;AAAA,IACJ,CAAC;AACD,uBAAmB;AAAA,MACf,SAAS;AAAA,MACT,UAAU,MAAM,MAAM;AAAA,IAC1B,CAAC;AAED,UAAM,eAAe,IAAI;AACzB,UAAM,QAAQ,IAAI,KAAK,UAAU,MAAM,GAAG;AAC1C,UAAM,YAAY,MAAM,MAAM,SAAS,CAAC;AACxC,UAAM,YAAY,IAAI,KAAK;AAE3B,mBAAe,YAAY,EAAE,KAAK,CAAC,cAAc;AAC7C,gBAAU;AACV,oBAAc,cAAc,WAAW,SAAS,EAC3C,KAAK,CAAC,iBAAiB;AACpB,cAAM,WAAW,aAAa,KAAK,QAAQ,SAAS;AACpD,cAAM,aAAa,SAAS,IAAI,CAAC,YAAY,QAAQ,KAAK,EAAE;AAC5D,8BAAsB,cAAc,YAAY,OAAO,EAClD,KAAK,CAAC,8BAA8B;AACjC,gBAAM,mBAAmB,SAAS,OAAO,CAAC,YAAY;AAClD,kBAAMA,aAAY,QAAQ,KAAK,GAAG,MAAM,GAAG,EAAE,IAAI;AACjD,kBAAM,iBAAiB,iBAAiBA,UAAS;AACjD,mBAAO,0BAA0B,KAAK,iBAAiB,cAAc;AAAA,UACzE,CAAC;AACD,gBAAM,aAAa,KAAK,gBAAgB,YAAY;AAAA,YAChD,iBAAiB;AAAA,YACjB,SAAS;AAAA,UACb,CAAC;AAED,gBAAM,aACF,cAAc,SAAY,6BAA6B;AAC3D,qBAAW,YAAY,KAAK,gBAAgB,MAAM,CAAC,GAAG,UAAU,CAAC;AAEjE,gBAAM,uBAAuB,CAACA,YAAW,aAAa,WAAW,aAAa;AAC1E,qBAAS,YAAY,EAAC,SAAS,UAAS,CAAC;AACzC,gBAAI,WAAW;AACX,+BAAiBA,UAAS,IAAI;AAAA,YAClC,OAAO;AACH,qBAAO,iBAAiBA,UAAS;AAAA,YACrC;AAAA,UACJ;AAGA,2BAAiB,QAAQ,CAAC,YAAY;AAClC,kBAAM,cAAc,QAAQ,KAAK;AACjC,kBAAMA,aAAY,QAAQ,KAAK;AAC/B,kBAAM,WAAW,KAAK,gBAAgB,UAAU;AAAA,cAC5C,OAAO,GAAG,WAAW;AAAA,cACrB,UAAU,CAAC,cACP,qBAAqBA,YAAW,aAAa,WAAW,QAAQ;AAAA,YACxE,CAAC;AACD,uBAAW,YAAY,QAAQ;AAAA,UACnC,CAAC;AAED,eAAK,YAAY,UAAU;AAC3B,eAAK,MAAM;AAAA,QACf,CAAC,EACA,MAAM,CAAC,UAAU;AACd,kBAAQ,MAAM,wBAAwB,KAAK;AAAA,QAC/C,CAAC;AAAA,MACT,CAAC,EACA,MAAM,CAAC,UAAU;AACd,gBAAQ,MAAM,wBAAwB,KAAK;AAAA,MAC/C,CAAC;AAAA,IACT,CAAC;AAAA,EACL;",
  "names": ["variantId"]
}
